{"files":[{"id":"de817983-3374-44d2-8cbe-b8d73dc0e81f","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Bangkok\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"9fac32a6-4d26-4e79-a4c2-ed88cf2b0ead","name":"รหัส","type":"server_js","source":"// Create a new sheet for every day\nfunction createNewSheetForDay() {\n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet();\n  var date \u003d new Date();\n  var formattedDate \u003d Utilities.formatDate(date, Session.getScriptTimeZone(), \"yyyy-MM-dd\");\n  var newSheet \u003d sheet.insertSheet(formattedDate);  // Create a new sheet with today\u0027s date\n  newSheet.appendRow([\"Timestamp\", \"Fingerprint ID\"]);  // Add headers\n  return newSheet.getSheetName();\n}\n\n// Log fingerprint data\nfunction doPost(e) {\n  var data \u003d JSON.parse(e.postData.contents);\n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(data.sheetName);\n  if (!sheet) {\n    sheet \u003d createNewSheetForDay();\n  }\n  sheet.appendRow([new Date(), data.fingerprintId]);\n  return ContentService.createTextOutput(\u0027Success\u0027);\n}\n\n// Send data to LINE at the end of the day\nfunction sendDailySummaryToLine() {\n  var lineToken \u003d \"YOUR_LINE_TOKEN\"; // LINE Notify token\n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet();\n  var yesterday \u003d new Date();\n  yesterday.setDate(yesterday.getDate() - 1);\n  var formattedDate \u003d Utilities.formatDate(yesterday, Session.getScriptTimeZone(), \"yyyy-MM-dd\");\n  var targetSheet \u003d sheet.getSheetByName(formattedDate);\n  \n  if (targetSheet) {\n    var range \u003d targetSheet.getDataRange();\n    var values \u003d range.getValues();\n    \n    // Create a summary message\n    var message \u003d \"Daily Summary (\" + formattedDate + \"):\\n\";\n    for (var i \u003d 1; i \u003c values.length; i++) {\n      message +\u003d \"Time: \" + values[i][0] + \", Fingerprint ID: \" + values[i][1] + \"\\n\";\n    }\n\n    // Send the message to LINE Notify\n    var options \u003d {\n      \"method\": \"post\",\n      \"headers\": {\n        \"Authorization\": \"Bearer \" + lineToken\n      },\n      \"payload\": {\n        \"message\": message\n      }\n    };\n    \n    UrlFetchApp.fetch(\"https://notify-api.line.me/api/notify\", options);\n  }\n}\n"}]}